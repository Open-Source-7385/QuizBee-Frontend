<div class="quiz-create-container">
  <!-- Header -->
  <div class="header">
    <h1 class="title">Modo Creativo</h1>
  </div>

  <!-- Success Message -->
  @if (successMessage()) {
    <div class="success-banner">
      ‚úÖ {{ successMessage() }}
    </div>
  }

  <!-- Error Message -->
  @if (error()) {
    <div class="error-banner">
      ‚ùå {{ error() }}
    </div>
  }

  <!-- Quiz Basic Info -->
  <div class="form-section">
    <div class="form-group">
      <label class="form-label">Nombre del Quizz:</label>
      <input
        type="text"
        class="form-input large"
        placeholder="Ej: Present Simple Basics"
        [value]="quizTitle()"
        (input)="quizTitle.set($any($event.target).value)"
      />
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Nivel de dificultad:</label>
        <select
          class="form-select"
          [value]="quizDifficulty()"
          (change)="quizDifficulty.set(+$any($event.target).value)">
          <option value="1">‚≠ê Nivel 1</option>
          <option value="2">‚≠ê‚≠ê Nivel 2</option>
          <option value="3">‚≠ê‚≠ê‚≠ê Nivel 3</option>
          <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Nivel 4</option>
          <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Nivel 5</option>
          <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Nivel 6</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Categor√≠a:</label>
        <select
          class="form-select"
          [value]="quizCategory()"
          (change)="quizCategory.set($any($event.target).value)">
          @for (category of categories; track category) {
            <option [value]="category">{{ category }}</option>
          }
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Tipo:</label>
        <select
          class="form-select"
          [value]="quizType()"
          (change)="quizType.set($any($event.target).value)">
          <option value="questions">Preguntas</option>
          <option value="voices">Voces</option>
          <option value="sounds">Sonidos</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Question List Sidebar -->
  <div class="content-wrapper">
    <div class="questions-sidebar">
      <div class="sidebar-header">
        <h3>Preguntas ({{ questions().length }})</h3>
        <button
          class="add-question-btn"
          (click)="addQuestion()"
          [disabled]="!canAddQuestion()">
          ‚ûï Agregar
        </button>
      </div>

      <div class="questions-list">
        @for (question of questions(); track question.id; let i = $index) {
          <div
            class="question-item"
            [class.active]="currentQuestionIndex() === i"
            (click)="selectQuestion(i)">
            <div class="question-item-content">
              <span class="question-number">Pregunta {{ i + 1 }}</span>
              <button
                class="remove-btn"
                (click)="removeQuestion(i); $event.stopPropagation()">
                üóëÔ∏è
              </button>
            </div>
            @if (question.text) {
              <p class="question-preview">{{ question.text }}</p>
            } @else {
              <p class="question-preview empty">Sin texto...</p>
            }
          </div>
        }
      </div>
    </div>

    <!-- Question Editor -->
    <div class="question-editor">
      @if (currentQuestion()) {
        <div class="editor-header">
          <h2>Pregunta {{ currentQuestionIndex() + 1 }}:</h2>
          <div class="points-input">
            <label>Puntos:</label>
            <input
              type="number"
              min="1"
              max="100"
              [value]="currentQuestion()!.points"
              (input)="updateQuestionPoints(+$any($event.target).value)"
            />
          </div>
        </div>

        <div class="form-group">
          <input
            type="text"
            class="form-input large question-input"
            placeholder="Escribe tu pregunta aqu√≠..."
            [value]="currentQuestion()!.text"
            (input)="updateQuestionText($any($event.target).value)"
          />
        </div>

        <div class="alternatives-section">
          <h3 class="alternatives-title">Alternativas:</h3>

          @for (alternative of currentQuestion()!.alternatives; track alternative.id; let i = $index) {
            <div class="alternative-item">
              <input
                type="radio"
                [name]="'correct-' + currentQuestionIndex()"
                [checked]="alternative.isCorrect"
                (change)="toggleCorrectAlternative(i)"
                class="radio-input"
              />
              <input
                type="text"
                class="form-input alternative-input"
                [placeholder]="'Alternativa ' + (i + 1)"
                [value]="alternative.text"
                (input)="updateAlternativeText(i, $any($event.target).value)"
                [class.correct]="alternative.isCorrect"
              />
              @if (alternative.isCorrect) {
                <span class="correct-badge">‚úì Correcta</span>
              }
            </div>
          }
        </div>

        <div class="helper-text">
          üí° Selecciona el radio button para marcar la respuesta correcta
        </div>
      }
    </div>
  </div>

  <!-- Summary -->
  <div class="summary-section">
    <div class="summary-item">
      <span class="summary-label">Total de preguntas:</span>
      <span class="summary-value">{{ questions().length }}</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">Puntos totales:</span>
      <span class="summary-value">{{ totalPoints() }}</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">Tiempo l√≠mite:</span>
      <span class="summary-value">{{ quizTimeLimit() / 60 }} minutos</span>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions-section">
    <button class="btn btn-secondary" (click)="cancel()">
      Cancelar
    </button>
    <button class="btn btn-secondary" (click)="saveDraft()">
      üíæ Guardar Borrador
    </button>
    <button
      class="btn btn-primary"
      [disabled]="!canSaveQuiz() || saving()"
      (click)="saveQuiz()">
      @if (saving()) {
        Guardando...
      } @else {
        üì§ Publicar
      }
    </button>
  </div>
</div>
